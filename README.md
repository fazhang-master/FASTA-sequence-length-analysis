# FASTA序列长度分析工具

**项目描述**：基于Python的命令行工具，用于统计FASTA文件中长度超过指定阈值的序列，生成专业分析报告和可视化图表，支持中文字体渲染

### ✨ 功能特性

- **统计分析**：计算长序列数量、占比、长度分布统计
- 可视化图表：生成序列长度直方图与箱线图（标注峰值区间和统计值）
- **中文兼容**：自动适配跨平台中文字体渲染
- **专业报告**：输出Markdown格式分析报告，含全局统计与序列ID列表
- **灵活阈值**：支持自定义最小长度过滤阈值（默认428 aa）

### 🔧 安装指南

- Python 3.8

- biopython 1.85

- matplotlib 3.10.3

- numpy 2.2.6

### 🚀 使用方法

```
python count_long_sequences.py -i <输入文件> [选项]
```

#### 🎛️ 命令行参数

|      参数      | 缩写 | 必选 |            默认值            |           说明           |
| :------------: | :--: | :--: | :--------------------------: | :----------------------: |
|   `--input`    | `-i` |  ✅   |              无              |    输入FASTA文件路径     |
|   `--output`   | `-o` |  ❌   | `sequence_length_report.txt` |     分析报告输出路径     |
|    `--plot`    | `-p` |  ❌   |  `sequence_length_plot.png`  |     分布图表输出路径     |
| `--min-length` | `-l` |  ❌   |            `428`             | 最小长度阈值（氨基酸数） |

### 📥 输入文件格式

支持标准FASTA格式，序列行可包含连接符 `-`（自动过滤）：

>序列ID1  
>MSTVHEILPKS...  
>序列ID2  
>MKTFIVGNPY...  

### 📤 输出内容

#### 1. **文本报告** (`sequence_length_report.txt`)

- **基础统计**：总序列数、长序列数、占比
- **全局统计**：最短/最长序列、平均长度、中位数
- **分布直方**：长度区间统计（如 `<100`, `100-300`, `>1000` aa）
- **序列ID列表**：所有长度超过阈值的序列ID

#### 2. **可视化图表** (`sequence_length_plot.png`)

|  图表类型  |                          内容说明                           |
| :--------: | :---------------------------------------------------------: |
| **直方图** | 序列长度分布 + 阈值线 + **峰值区间标注**（如 `300-350 aa`） |
| **箱线图** |   长度四分位点 + 异常值标注 + 统计值（最短/最长/中位数）    |

### 💻 示例命令

```
# 基础分析（使用默认阈值428）  
python count_long_sequences.py -i ./cas12.fasta  

# 完整分析（自定义阈值358，指定输出路径）  
python count_long_sequences.py \  
  -i ./input.fasta \  
  -o ./reports/cas12_report.md \  
  -p ./plots/cas12_distribution.png \  
  -l 358
```

